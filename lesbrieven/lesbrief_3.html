<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Theme Made By www.w3schools.com - No Copyright -->
  <title>D3.js module</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">
  <script src="//code.jquery.com/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/codeblock.css">
  <link rel="stylesheet" href="../css/style_solar.css">
  <link rel="stylesheet" href="../css/bar_chart.css">
  <script src="../js/codeblock.js"></script>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">D3.js</a>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="../lesbrieven/lesbrief_1.html">Lesbrief 1</a></li>
        <li><a href="../lesbrieven/lesbrief_2.html">Lesbrief 2</a></li>
        <li><a href="../lesbrieven/lesbrief_3.html">Lesbrief 3</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- First Container -->
<div class="container-fluid bg-1 text-center">
  <h3 class="margin">Lesbrief 3</h3>
  <p>Wederom beginnen we met een voorbeeld van D3.js, en zoals je misschien al verwacht is dit voorbeeld van Mike Bostock met zijn <a href="https://bl.ocks.org/mbostock/1353700">Epicyclic Gearing</a>! In deze lesbrief duiken we dieper in op de wondere wereld van D3.js. Zo gaan we bijvoorbeeld kijken hoe selecties werken, en gaan onze eerst echte barchart maken!</p>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="../js/gear_of_solar.js"></script>
  <form style="text-align:left; margin-left:15%; margin-top:25px;">
    <input type="radio" name="reference" id="ref-annulus">
    <label for="ref-annulus">Annulus</label><br>
    <input type="radio" name="reference" id="ref-planet" checked>
    <label for="ref-planet">Planets</label><br>
    <input type="radio" name="reference" id="ref-sun">
    <label for="ref-sun">Sun</label>
  </form>
  <div class="solar_gears" width="960" height="600"></div>
  <script>
    solar_gears(".solar_gears");
  </script>
</div>

<!-- Second Container (Grid) -->
<div class="container-fluid bg-5 text-center">
  <h3 class="margin">Een korte uitbreiding op selecties</h3><br>
  <p>Nu we zelf een SVG kunnen maken, is het misschien zaak om wat beter te begrijpen hoe het selecteren van dingen nou precies werkt. Zo kunnen weten we beter wat we er mee kunnen natuurlijk! We hebben bijvoorbeeld d3.select() en d3.selectAll() al gezien. De eerste maakt een selectie van het eerste element dat er gevonden kan worden in de DOM met een bepaalde specificatie (tagg/ID/class etc). En de tweede geeft een array terug van alle elementen die voldoen aan de criteria. Er wordt verwacht dat je alle code zelf overneemt en zelf een beetje gaat spelen met de code. Hier onder zie je code die demonstreren hoe bepaalde selecties werken.</p>

  <div class="row">
  <div class="col-md-6">
  <figure>
        <figcaption id="example1-caption">Selectie.html</figcaption>
  <pre
    aria-describedby="example1-description"
    aria-labelledby="example1-caption"><code
    contenteditable="true"
    tabindex="0"
    spellcheck="false">
  <b>&lt;!DOCTYPE html&gt;</b>
  <i>&lt;!-- Dit is een normale HTML file --&gt;</i>
  <b>&lt;html&gt;</b>
  <b>&lt;head&gt;</b>
    <b>&lt;title&gt;</b>Selectie voorbeelden<b>&lt;/title&gt;</b>
    <i>&lt;!-- D3 inladen --&gt;</i>
    <b>&lt;<strong>script</strong> src</b>=<u>"https://d3js.org/d3.v3.min.js"</u> <b>charset</b>=<u>"utf-8"</u>&gt;<strong>&lt;/script</strong>&gt;
    <i>&lt;!-- Inladen van mijn JavaScript code --&gt;</i>
    <b>&lt;<strong>script</strong> src</b>=<u>"js/selectie.js"</u> <b>charset</b>=<u>"utf-8"</u>&gt;<strong>&lt;/script</strong>&gt;
  <b>&lt;/head&gt;</b>
  <b>&lt;body&gt;</b>
    <i>&lt;!-- Een zooitje p elementen als voorbeeld --&gt;</i>
    <b>&lt;p&gt;</b>Hallo<b>&lt;/p&gt;</b>
    <b>&lt;p&gt;</b>Doei<b>&lt;/p&gt;</b>
    <b>&lt;p&gt;</b>Hallo<b>&lt;/p&gt;</b>
    <b>&lt;p&gt;</b>Doei<b>&lt;/p&gt;</b>
    <b>&lt;p&gt;</b>Hallo<b>&lt;/p&gt;</b>
    <b>&lt;p&gt;</b>Doei<b>&lt;/p&gt;</b>
    <b>&lt;p&gt;</b>Hallo<b>&lt;/p&gt;</b>
    <b>&lt;p&gt;</b>Doei<b>&lt;/p&gt;</b>
  <b>&lt;/body&gt;</b>
  <b>&lt;/html&gt;</b>
    </code></pre>
      </figure>
  </div>
  <div class="col-md-6">
  <figure>
        <figcaption id="example1-caption">selectie.js</figcaption>
  <pre
    aria-describedby="example1-description"
    aria-labelledby="example1-caption"><code
    contenteditable="true"
    tabindex="0"
    spellcheck="false">
  <b>// Zoals je ziet wordt alleen het eerste element blauw</b>
  d3.<b>select</b>(<u>"p"</u>).style(<u>"color"</u>, <u>"blue"</u>);

  <b>// Alle "p" elementen krijgen font-weight bold (dikgedrukt)</b>
  d3.selectAll(<u>"p"</u>).style(<u>"font-weight"</u>, <u>"bold"</u>);

  <b>// Alle even p elementen worden goudkleurig gemaakt!</b>
  d3.selectAll(<u>"p:nth-child(even)"</u>).style(<u>"color"</u>, <u>"gold"</u>).html(<u>"Dit is even"</u>);

  <b>// Maar zoals je ziet, als we hetzelfde doen maar dan met d3.select()
     word alleen het eerste even element geselecteerd.</b>
  d3.<b>select</b>(<u>"p:nth-child(even)"</u>).style(<u>"color"</u>, <u>"skyblue"</u>).html(<u>"Dit is even, zoals je ziet wordt met select alleen het eerste element gepakt."</u>);

  <b>// Op dezelfde manier kunnen we een streep trekken door de oneven elementen</b>
  d3.selectAll(<u>"p:nth-child(odd)"</u>).style(<u>"text-decoration"</u>, <u>"line-through"</u>);

  <b>// Ook kunnen we de laatste selecteren</b>
  d3.<b>select</b>(<u>"p:last-of-type"</u>).html(<u>"Dit is het laatste element"</u>);

  <b>// Of de derde</b>
  d3.<b>select</b>(<u>"p:nth-child(3)"</u>).style(<u>"color"</u>, <u>"purple"</u>).html(<u>"Dit is even"</u>);
    </code></pre>
      </figure>
  </div>
  </div>

  <p>Hier onder zie je hoe de code eruit ziet als het gerunned wordt. Kijk of je snapt hoe de JavaScript effect heeft op de verschillende elementen.</p>
<div class="container">
  <div class="row">
  <div class="col-md-6">
  <p>Zonder JavaScript</p><br>
  <p>Hallo</p>
  <p>Doei</p>
  <p>Hallo</p>
  <p>Doei</p>
  <p>Hallo</p>
  <p>Doei</p>
  <p>Hallo</p>
  <p>Doei</p>
  </div class="col-md-6">
  <p>Met JavaScript</p><br>
  <p class="selection_preview">Hallo</p>
  <p class="selection_preview">Doei</p>
  <p class="selection_preview">Hallo</p>
  <p class="selection_preview">Doei</p>
  <p class="selection_preview">Hallo</p>
  <p class="selection_preview">Doei</p>
  <p class="selection_preview">Hallo</p>
  <p class="selection_preview">Doei</p>
  <div>
  </div>
  </div>
</div>

  <script type="text/javascript">
    // Zoals je ziet wordt alleen het eerste element blauw
  d3.select(".selection_preview").style("color", "blue");

  // Alle "p" elementen krijgen font-weight bold (dikgedrukt)
  d3.selectAll(".selection_preview").style("font-weight", "bold");

  // Alle even p elementen worden goudkleurig gemaakt!
  d3.selectAll(".selection_preview:nth-child(even)").style("color", "gold").html("Dit is even");

  // Maar zoals je ziet, als we hetzelfde doen maar dan met d3.select()
     //word alleen het eerste even element geselecteerd.
  d3.select(".selection_preview:nth-child(even)").style("color", "skyblue").html("Dit is even, zoals je ziet wordt met select alleen het eerste element gepakt.");

  // Op dezelfde manier kunnen we een streep trekken door de oneven elementen
  d3.selectAll(".selection_preview:nth-child(odd)").style("text-decoration", "line-through");

  // Ook kunnen we de laatste selecteren
  d3.select(".selection_preview:last-of-type").html("Dit is het laatste element");

  // Of de derde
  d3.select(".selection_preview:nth-child(3)").style("color", "purple").html("Dit is even");
  </script>
</div>

<!-- Second Container (Grid) -->
<div class="container-fluid bg-3 text-center">
  <h3 class="margin">Onze eerste barchart</h3>
  <p>Nu we weten hoe selecties werken (snap je elke soort selectie?) gaan we kijken of we een simpele barchart kunnen maken.
  Een goede barchart heeft altijd bepaalde elementen die ervoor zorgen dat het goed leesbaar is. Zo kan je hier onder een voorbeeld zien, ook gemaakt in D3. Zoals we zien is er een titel aanwezig die beschrijvend is voor wat de grafiek laat zien. Er wordt duidelijk gemaakt uit welk jaar de data komt, wat de variabelen zijn en welke plaats. Verder moeten er natuurlijk altijd assen zijn! De stapgrootte van je assen moeten bijvoorbeeld logisch zijn. Hier gaat het bijvoorbeeld per half uur, of per maand. Bij beide assen zijn er ook titels die zeggen welke variabele de as representeert. Verder is het laatste (maar minstens net zo belangrijk) element, de bronvermelding. Deze data is bijvoorbeeld gehaald van de KNMI site, waar je heel veel informatie over het weer kan halen. Als we hen niet zouden melden hier, zou het natuurlijk erg onbeleefd naar hun zijn omdat zij alle informatie hebben vergaard. Maar het geeft je lezer ook het idee dat wat ze uit de grafiek lezen echt waar is, omdat het van een betrouwbare bron komt. Belangrijk dus!</p>

<div id="bar_chart_example"></div>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
<script src="../js/bar_chart.js" type="text/javascript"></script>

<p>Zoals je hier boven misschien wel hebt gezien, is er ook extraatje te vinden in de barchart. Er is namelijk een on mouseover functionaliteit in de grafiek gemaakt. Als je bijvoorbeeld met je muis over een van de staven gaat, komt er een pop-up die je de waarde van de staaf verteld. Dit zullen wij ook maken! Maar wel pas aan het einde, dus heb geduld.</p>

<h3 class="margin">Het maken van de bars</h3>
<p>Zoals we in lesbrief 2 hebben besproken kan je vrij gemakkelijk een paar rects maken, en dat lijkt al snel op een barchart. Dit zou bijvoorbeeld kunnen met de code hier onder.</p>

<div class="row">
  <div class="col-md-6">
<figure>
        <figcaption id="example1-caption">script.js</figcaption>
  <pre
    aria-describedby="example1-description"
    aria-labelledby="example1-caption"><code
    contenteditable="true"
    tabindex="0"
    spellcheck="false">
    <b>// Maak de SVG container</b>
    <strong>var</strong> svgContainer <b>=</b> d3.<b>select</b>(<u>"#voorbeeld"</u>).append(<u>"svg"</u>)
      .attr(<u>"width"</u>, 400</b>)
      .attr(<u>"height"</u>, 400</b>);

    <b>// Teken de rechthoek</b>
    <strong>var</strong> rectangle1 <b>=</b> svgContainer.append(<u>"rect"</u>)
      .attr(<u>"x"</u>, <b>10</b>)
      .attr(<u>"y"</u>, <b>10</b>)
      .attr(<u>"width"</u>, <b>250</b>)
      .attr(<u>"height"</u>, <b>50</b>);

    <b>// Teken de rechthoek</b>
    <strong>var</strong> rectangle2 <b>=</b> svgContainer.append(<u>"rect"</u>)
      .attr(<u>"x"</u>, <b>10</b>)
      .attr(<u>"y"</u>, <b>90</b>)
      .attr(<u>"width"</u>, <b>100</b>)
      .attr(<u>"height"</u>, <b>50</b>);

    <b>// Teken de rechthoek</b>
    <strong>var</strong> rectangle3 <b>=</b> svgContainer.append(<u>"rect"</u>)
      .attr(<u>"x"</u>, <b>10</b>)
      .attr(<u>"y"</u>, <b>170</b>)
      .attr(<u>"width"</u>, <b>354</b>)
      .attr(<u>"height"</u>, <b>50</b>);

    <b>// Teken de rechthoek</b>
    <strong>var</strong> rectangle4 <b>=</b> svgContainer.append(<u>"rect"</u>)
      .attr(<u>"x"</u>, <b>10</b>)
      .attr(<u>"y"</u>, <b>250</b>)
      .attr(<u>"width"</u>, <b>145</b>)
      .attr(<u>"height"</u>, <b>50</b>);

    <b>// Teken de rechthoek</b>
    <strong>var</strong> rectangle5 <b>=</b> svgContainer.append(<u>"rect"</u>)
      .attr(<u>"x"</u>, <b>10</b>)
      .attr(<u>"y"</u>, <b>330</b>)
      .attr(<u>"width"</u>, <b>296</b>)
      .attr(<u>"height"</u>, <b>50</b>);

  </code></pre>
      </figure>
</div>
<div class="col-md-6">
  <p class="text_row">Maar zoals je misschien ook wel al door hebt is dit niet echt de meest effectieve manier om deze code te schrijven. Het zit bijvoorbeeld vol met allemaal code die hetzelfde is (ook wel "duplicate code" genoemd). Zo kunnen we bijvoorbeeld een array maken met alle waardes erin, zodat we niet telkens de breedte van de bar hoeven te specificeren. En misschien is er ook wel een functie die de afstanden tussen de bars automatisch berekend. En hoewel dit er al wel op lijkt, moeten we alsnog ook wel alle andere elementen van een bargraph maken (denk aan assen, titels, bronvermelding etc). Plus een echte bargraph is over het algemeen vaak rechtop gepositioneerd i.p.v. op zijn zij.</p>
  <div class="preview_svg" id="voorbeeld"></div>
</div>
</div>



<script type="text/javascript">

// Maak de SVG container
var svgContainer = d3.select("#voorbeeld").append("svg")
  .attr("width", 400)
  .attr("height", 400)
  .style("border", "1px solid black");

// Teken de rechthoek
var rectangle = svgContainer.append("rect")
  .attr("x", 10)
  .attr("y", 10)
  .attr("width", 250)
  .attr("height", 50)
  .style("fill", "steelblue");

var rectangle2 = svgContainer.append("rect")
  .attr("x", 10)
  .attr("y", 90)
  .attr("width", 100)
  .attr("height", 50)
  .style("fill", "steelblue");

var rectangle3 = svgContainer.append("rect")
  .attr("x", 10)
  .attr("y", 170)
  .attr("width", 354)
  .attr("height", 50)
  .style("fill", "steelblue");

var rectangle4 = svgContainer.append("rect")
  .attr("x", 10)
  .attr("y", 250)
  .attr("width", 145)
  .attr("height", 50)
  .style("fill", "steelblue");

var rectangle5 = svgContainer.append("rect")
  .attr("x", 10)
  .attr("y", 330)
  .attr("width", 296)
  .attr("height", 50)
  .style("fill", "steelblue");

</script>

</div>

<!-- Footer -->
<footer class="container-fluid bg-4 text-center">
  <p>Bootstrap Theme Made By <a href="https://www.w3schools.com">www.w3schools.com</a><br> Module Made By Bas Châtel</p>
</footer>

</body>
</html>
